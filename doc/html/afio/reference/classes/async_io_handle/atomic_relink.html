<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>atomic_relink</title>
<link rel="stylesheet" href="../../../../../../libs/afio/doc/html/myboostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="../../../../afio.html" title="Chapter&#160;1.&#160;Boost.AFIO 1.30">
<link rel="up" href="../async_io_handle.html" title="async_io_handle">
<link rel="prev" href="unlink.html" title="unlink">
<link rel="next" href="../directory_entry.html" title="directory_entry">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="unlink.html"><img src="../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../async_io_handle.html"><img src="../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../../../afio.html"><img src="../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="../directory_entry.html"><img src="../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h5 class="title">
<a name="afio.reference.classes.async_io_handle.atomic_relink"></a><a class="link" href="atomic_relink.html" title="atomic_relink">atomic_relink</a>
</h5></div></div></div>
<p>
            <a class="indexterm" name="idp35336632"></a>
Links the file to a new location and unlinks the file from its present
            location as determined by path(true), <span class="emphasis"><em>atomically overwriting
            any file entry at the new location</em></span>. Very useful for preparing
            file content elsewhere and once ready, atomically making it visible at
            some named location to other processes. Note that operating systems with
            an unstable path(true) may relink any hard link to the file to the new
            location.
          </p>
<h6>
<a name="afio.reference.classes.async_io_handle.atomic_relink.h0"></a>
            <span><a name="afio.reference.classes.async_io_handle.atomic_relink.description"></a></span><a class="link" href="atomic_relink.html#afio.reference.classes.async_io_handle.atomic_relink.description">Description</a>
          </h6>
<p>
            Note that not all filing systems guarantee the atomicity of the relink
            itself (i.e. the file may appear at two locations in the filing system
            for a period of time), though all supported platforms do guarantee the
            atomicity of the replaced location i.e. the location you are relinking
            to will always refer to some valid file to all readers, and will never
            be deleted or missing. Some filing systems may also fail to do the unlink
            if power is lost close to the relinking operation.
          </p>
<p>
            On Windows, the destination directory cannot have any handle opened to
            it with delete/rename privileges (<code class="literal"><code class="computeroutput"><span class="identifier">file_flags</span><span class="special">::</span><span class="identifier">Write</span></code></code>)
            anywhere in the system. This is an operating system limitation.
          </p>
<p>
            Be aware that on Windows AFIO operates exclusively in the NT kernel namespace,
            NOT the Win32 namespace, and therefore paths you supply are converted
            by <code class="literal"><code class="computeroutput"><span class="identifier">afio</span><span class="special">::</span><span class="identifier">path</span></code></code> in NT kernel namespace
            paths. <code class="literal"><code class="computeroutput"><span class="identifier">normalise_path</span><span class="special">()</span></code></code> can convert an afio path
            back to a Filesystem TS path for you, but note that this may not be the
            path that was supplied originally. NT kernel namespace paths have a 32,767
            character limit and an almost POSIX like lack of restrictions on naming
            or historical behaviour quirks, but as a result AFIO does not support
            DOS short names or any of the other historical Win32 filing system baggage.
          </p>
<h6>
<a name="afio.reference.classes.async_io_handle.atomic_relink.h1"></a>
            <span><a name="afio.reference.classes.async_io_handle.atomic_relink.synopsis"></a></span><a class="link" href="atomic_relink.html#afio.reference.classes.async_io_handle.atomic_relink.synopsis">Synopsis</a>
          </h6>
<pre class="programlisting"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="identifier">async_io_handle</span><span class="special">::</span><span class="identifier">atomic_relink</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">async_path_op_req</span> <span class="special">&amp;</span> <span class="identifier">req</span><span class="special">)</span></pre>
<h6>
<a name="afio.reference.classes.async_io_handle.atomic_relink.h2"></a>
            <span><a name="afio.reference.classes.async_io_handle.atomic_relink.parameters"></a></span><a class="link" href="atomic_relink.html#afio.reference.classes.async_io_handle.atomic_relink.parameters">Parameters</a>
          </h6>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                    <p>
                      Type
                    </p>
                  </th>
<th>
                    <p>
                      Concept
                    </p>
                  </th>
<th>
                    <p>
                      Name
                    </p>
                  </th>
<th>
                    <p>
                      Description
                    </p>
                  </th>
</tr></thead>
<tbody><tr>
<td>
                    <p>
                      const async_path_op_req &amp;
                    </p>
                  </td>
<td>
                  </td>
<td>
                    <p>
                      req
                    </p>
                  </td>
<td>
                    <p>
                      The absolute or relative (in which case precondition specifies
                      a directory) path to relink to.
                    </p>
                  </td>
</tr></tbody>
</table></div>
<h6>
<a name="afio.reference.classes.async_io_handle.atomic_relink.h3"></a>
            <span><a name="afio.reference.classes.async_io_handle.atomic_relink.header"></a></span><a class="link" href="atomic_relink.html#afio.reference.classes.async_io_handle.atomic_relink.header">Header</a>
          </h6>
<p>
            <code class="computeroutput"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">afio</span><span class="special">/</span><span class="identifier">afio</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span></code>
          </p>
<h6>
<a name="afio.reference.classes.async_io_handle.atomic_relink.h4"></a>
            <span><a name="afio.reference.classes.async_io_handle.atomic_relink.race_guarantees"></a></span><a class="link" href="atomic_relink.html#afio.reference.classes.async_io_handle.atomic_relink.race_guarantees">Race
            Guarantees</a>
          </h6>
<p>
            </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>Operating system</th>
<th>Race guarantees under a changing file system</th>
</tr></thead>
<tbody>
<tr>
<td>FreeBSD, Linux</td>
<td>Race free up to the containing directory for both source
            and target.</td>
</tr>
<tr>
<td>OS X</td>
<td>No guarantees.</td>
</tr>
<tr>
<td>Windows</td>
<td>Race free for source if handle open,
            else up to the containing directory. Race free up to the target directory.</td>
</tr>
</tbody>
</table></div>
<p>
          </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2013-2015 Niall Douglas
      and Paul Kirth<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="unlink.html"><img src="../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../async_io_handle.html"><img src="../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../../../afio.html"><img src="../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="../directory_entry.html"><img src="../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
